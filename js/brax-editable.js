!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}("undefined"!=typeof self?self:this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=26)}([function(t,e,i){"use strict";function n(t){this.dropdown=null,this.el=t.element,this.enabled=!t.readOnly&&!t.removeOnly,this.input=null,this.items=null,this.options={},this.templates=s({},n.Templates),this.term="",this.setOptions(t),t.value?this.setValue(t.value,{triggerChange:!1}):this.setData(t.data||null,{triggerChange:!1}),this.el.setAttribute("tabindex",t.tabIndex||0),this.events=new o(this.el,this),this.events.on({blur:this._blur,mouseenter:this._mouseenter,mouseleave:this._mouseleave,"selectivity-close":this._closed})}var s=i(3),r=i(20),o=i(21),l=i(23);s(n.prototype,{$:function(t){return this.el.querySelector(t)},close:function(){this._clearCloseTimeout(),this.dropdown&&(this.dropdown.close(),this.dropdown=null)},destroy:function(){this.events.destruct();for(var t=this.el;t.firstChild;)t.removeChild(t.firstChild);t.selectivity=null},filterResults:function(t){return t},focus:function(){this._clearCloseTimeout(),this._focusing=!0,this.input&&this.input.focus(),this._focusing=!1},getData:function(){return this._data},getItemForId:function(t){var e=this.items;return e?n.findNestedById(e,t):null===t?null:{id:t,text:""+t}},getRelatedItemId:function(t){for(var e=t.target||t;e&&!e.hasAttribute("data-item-id");)e=e.parentNode;if(!e)return null;var i=e.getAttribute("data-item-id");if(n.findById(this._data||[],i))return i;for(var s=this.dropdown;s;){if(n.findNestedById(s.results,i))return i;s=s.submenu}var r=parseInt(i,10);return""+r===i?r:i},getValue:function(){return this._value},initInput:function(t,e){this.input=t;var i=this;(this.options.inputListeners||n.InputListeners).forEach(function(n){n(i,t,e)}),e&&!1===e.search||t.addEventListener("keyup",function(t){t.defaultPrevented||i.search(t.target.value)})},open:function(){if(!this._opening&&!this.dropdown&&this.triggerEvent("selectivity-opening")){this._opening=!0;var t=this.options.dropdown||n.Dropdown;t&&(this.dropdown=new t(this,{items:this.items,position:this.options.positionDropdown,query:this.options.query,showSearchInput:!1!==this.options.showSearchInputInDropdown})),this.search(""),this.focus(),l(this.el,"open",!0),this._opening=!1}},positionDropdown:function(){this.dropdown&&this.dropdown.position()},search:function(t){this.open(),this.dropdown&&this.dropdown.search(t)},setData:function(t,e){e=e||{},t=this.validateData(t),this._data=t,this._value=this.getValueForData(t),!1!==e.triggerChange&&this.triggerChange()},setOptions:function(t){t=t||{};var e=this;n.OptionListeners.forEach(function(i){i(e,t)}),"items"in t&&(this.items=t.items?n.processItems(t.items):null),"templates"in t&&s(this.templates,t.templates),s(this.options,t),this.enabled=!this.options.readOnly&&!this.options.removeOnly},setValue:function(t,e){e=e||{},t=this.validateValue(t),this._value=t,this.options.initSelection?this.options.initSelection(t,function(i){this._value===t&&(this._data=this.validateData(i),!1!==e.triggerChange&&this.triggerChange())}.bind(this)):(this._data=this.getDataForValue(t),!1!==e.triggerChange&&this.triggerChange())},template:function(t,e){var i=this.templates[t];if(!i)throw new Error("Unknown template: "+t);if("function"==typeof i){var n=i(e);return"string"==typeof n?n.trim():n}return i.render?i.render(e).trim():i.toString().trim()},triggerChange:function(t){var e=s({value:this._value},t);this.triggerEvent("change",e),this.triggerEvent("selectivity-change",e)},triggerEvent:function(t,e){var i=document.createEvent("Event");return i.initEvent(t,!1,!0),s(i,e),this.el.dispatchEvent(i),!i.defaultPrevented},validateItem:function(t){if(t&&n.isValidId(t.id)&&r(t.text))return t;throw new Error("Item should have id (number or string) and text (string) properties")},_blur:function(){this._focusing||this.el.classList.contains("hover")||(this._clearCloseTimeout(),this._closeTimeout=setTimeout(this.close.bind(this),166))},_clearCloseTimeout:function(){this._closeTimeout&&(clearTimeout(this._closeTimeout),this._closeTimeout=0)},_closed:function(){this.dropdown=null,l(this.el,"open",!1)},_mouseleave:function(t){this.el.contains(t.relatedTarget)||l(this.el,"hover",!1)},_mouseenter:function(){l(this.el,"hover",!0)}}),n.Dropdown=null,n.InputListeners=[],n.Inputs={},n.OptionListeners=[],n.Templates={},n.findById=function(t,e){var i=n.findIndexById(t,e);return i>-1?t[i]:null},n.findIndexById=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1},n.findNestedById=function(t,e){for(var i=0,s=t.length;i<s;i++){var r,o=t[i];if(o.id===e?r=o:o.children?r=n.findNestedById(o.children,e):o.submenu&&o.submenu.items&&(r=n.findNestedById(o.submenu.items,e)),r)return r}return null},n.inherits=function(t,e,i){return t.prototype=s(Object.create(e.prototype),{constructor:t},i),function(t,i){e.prototype[i].apply(t,Array.prototype.slice.call(arguments,2))}},n.isValidId=function(t){return"number"==typeof t||r(t)},n.matcher=function(t,e){var i=null;if(n.transformText(t.text).indexOf(e)>-1)i=t;else if(t.children){var s=t.children.map(function(t){return n.matcher(t,e)}).filter(function(t){return!!t});s.length&&(i={id:t.id,text:t.text,children:s})}return i},n.processItem=function(t){if(n.isValidId(t))return{id:t,text:""+t};if(t&&(n.isValidId(t.id)||t.children)&&r(t.text))return t.children&&(t.children=n.processItems(t.children)),t;throw new Error("invalid item")},n.processItems=function(t){if(Array.isArray(t))return t.map(n.processItem);throw new Error("invalid items")},n.transformText=function(t){return t.toLowerCase()},t.exports=n},function(t,e,i){function n(t){return null==t?void 0===t?u:l:a&&a in Object(t)?r(t):o(t)}var s=i(4),r=i(30),o=i(31),l="[object Null]",u="[object Undefined]",a=s?s.toStringTag:void 0;t.exports=n},function(t,e){function i(t){return null!=t&&"object"==typeof t}t.exports=i},function(t,e,i){var n=i(9),s=i(36),r=i(37),o=i(7),l=i(18),u=i(46),a=Object.prototype,c=a.hasOwnProperty,h=r(function(t,e){if(l(e)||o(e))return void s(e,u(e),t);for(var i in e)c.call(e,i)&&n(t,i,e[i])});t.exports=h},function(t,e,i){var n=i(5),s=n.Symbol;t.exports=s},function(t,e,i){var n=i(13),s="object"==typeof self&&self&&self.Object===Object&&self,r=n||s||Function("return this")();t.exports=r},function(t,e){function i(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=i},function(t,e,i){function n(t){return null!=t&&r(t.length)&&!s(t)}var s=i(12),r=i(16);t.exports=n},function(t,e){var i=Array.isArray;t.exports=i},function(t,e,i){function n(t,e,i){var n=t[e];l.call(t,e)&&r(n,i)&&(void 0!==i||e in t)||s(t,e,i)}var s=i(10),r=i(14),o=Object.prototype,l=o.hasOwnProperty;t.exports=n},function(t,e,i){function n(t,e,i){"__proto__"==e&&s?s(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}var s=i(11);t.exports=n},function(t,e,i){var n=i(27),s=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=s},function(t,e,i){function n(t){if(!r(t))return!1;var e=s(t);return e==l||e==u||e==o||e==a}var s=i(1),r=i(6),o="[object AsyncFunction]",l="[object Function]",u="[object GeneratorFunction]",a="[object Proxy]";t.exports=n},function(t,e,i){(function(e){var i="object"==typeof e&&e&&e.Object===Object&&e;t.exports=i}).call(e,i(29))},function(t,e){function i(t,e){return t===e||t!==t&&e!==e}t.exports=i},function(t,e){function i(t){return t}t.exports=i},function(t,e){function i(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}var n=9007199254740991;t.exports=i},function(t,e){function i(t,e){return!!(e=null==e?n:e)&&("number"==typeof t||s.test(t))&&t>-1&&t%1==0&&t<e}var n=9007199254740991,s=/^(?:0|[1-9]\d*)$/;t.exports=i},function(t,e){function i(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}var n=Object.prototype;t.exports=i},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){function n(t){return"string"==typeof t||!r(t)&&o(t)&&s(t)==l}var s=i(1),r=i(8),o=i(2),l="[object String]";t.exports=n},function(t,e,i){"use strict";function n(t,e){this.context=e||null,this.el=t,this.events={},this._onEvent=this._onEvent.bind(this)}var s=i(3),r=i(20),o=i(22),l=["blur","focus","mouseenter","mouseleave","scroll"];s(n.prototype,{destruct:function(){Object.keys(this.events).forEach(function(t){var e=l.indexOf(t)>-1;this.el.removeEventListener(t,this._onEvent,e)},this),this.context=null,this.el=null,this.events=null},off:function(t,e,i){if(r(e)||(i=e,e=""),i){var n=this.events[t];if(n&&(n=n[e]))for(var s=0;s<n.length;s++)n[s]===i&&(n.splice(s,1),s--)}else this.events[t][e]=[]},on:function(t,e,i){if(r(t)){if(r(e)||(i=e,e=""),!this.events.hasOwnProperty(t)){var n=l.indexOf(t)>-1;this.el.addEventListener(t,this._onEvent,n),this.events[t]={}}this.events[t].hasOwnProperty(e)||(this.events[t][e]=[]),this.events[t][e].indexOf(i)<0&&this.events[t][e].push(i)}else{var s=t;for(var o in s)if(s.hasOwnProperty(o)){var u=o.split(" ");u.length>1?this.on(u[0],u[1],s[o]):this.on(u[0],s[o])}}},_onEvent:function(t){function e(e){for(var i=0;i<e.length;i++)e[i].call(s,t)}var i=!1,n=t.stopPropagation;t.stopPropagation=function(){n.call(t),i=!0};for(var s=this.context,r=t.target,l=this.events[t.type.toLowerCase()];r&&r!==this.el&&!i;){for(var u in l)u&&l.hasOwnProperty(u)&&o(r,u)&&e(l[u]);r=r.parentElement}!i&&l.hasOwnProperty("")&&e(l[""])}}),t.exports=n},function(t,e,i){"use strict";t.exports=function(t,e){return(t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector).call(t,e)}},function(t,e,i){"use strict";t.exports=function(t,e,i){t&&t.classList[i?"add":"remove"](e)}},function(t,e,i){"use strict";t.exports=function(t){t.stopPropagation()}},function(t,e,i){function n(t){return t=r(t),t&&l.test(t)?t.replace(o,s):t}var s=i(66),r=i(68),o=/[&<>"']/g,l=RegExp(o.source);t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(0);i(60),i(64),i(65);var o=function(){function t(e){n(this,t),this.element=e,this._text=this.element.innerHTML,this._value=this.element.getAttribute("data-value")?this.element.getAttribute("data-value"):this._text,this.type=this.element.getAttribute("data-type")?this.element.getAttribute("data-type"):"text",this.key=this.element.getAttribute("data-key"),this.url=this.element.getAttribute("data-url"),this.method=this.element.getAttribute("data-get")?"GET":"POST",this.source=this.element.getAttribute("data-source"),this.template=this.element.getAttribute("data-template"),this.hook(),this._isEditing=!1,this.hasInputs=!1,this._inputsEnabled=!0,this.options=[]}return s(t,[{key:"hook",value:function(){var t=this;this.element.classList.add("brax-editable"),this.textContainer=document.createElement("span"),this.textContainer.setAttribute("data-text",1),this.textContainer.innerHTML=this.element.innerHTML,this.element.innerHTML="",this.element.appendChild(this.textContainer),this.inputContainer=document.createElement("span"),this.inputContainer.setAttribute("data-input",1),this.inputContainer.style.display="none",this.element.appendChild(this.inputContainer),this.element.addEventListener("click",function(e){if(!t.isEditing)return t.isEditing=!0,e.preventDefault(),e.stopPropagation(),!1}),this.element.setAttribute("data-editing",0),this.element.setAttribute("data-hooked",1)}},{key:"fetchList",value:function(){var t=this;if(!this.source)return console.error("No source for list provided"),!1;fetch(this.source).then(function(t){return 200===t.status?t.json():(console.error("list response error",t),t)}).then(function(e){if(e.items){if(!t.isEditing)return;t.options=[];var i=!0,n=!1,s=void 0;try{for(var r,o=e.items[Symbol.iterator]();!(i=(r=o.next()).done);i=!0){var l=r.value,u={};u.value=l.value,u.text=l.text,l.pk&&(u.value=l.pk),l.id&&(u.value=l.id),l.extra&&(u.extra=l.extra),u.id=u.value,t.options.push(u)}}catch(t){n=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw s}}if(t.inputField){var a=!0,c=!1,h=void 0;try{for(var d,p=t.options[Symbol.iterator]();!(a=(d=p.next()).done);a=!0){var u=d.value,f=document.createElement("option");f.value=u.value,f.innerHTML=u.text,t.value==f.value&&f.setAttribute("selected","selected"),t.inputField.appendChild(f)}}catch(t){c=!0,h=t}finally{try{!a&&p.return&&p.return()}finally{if(c)throw h}}}else if(t.selectivity){var v=!0,m=!1,g=void 0;try{for(var y,b=t.options[Symbol.iterator]();!(v=(y=b.next()).done);v=!0){var u=y.value;t.selectivity.items.push(u),u.value==t.value&&t.selectivity.setValue(u.value)}}catch(t){m=!0,g=t}finally{try{!v&&b.return&&b.return()}finally{if(m)throw g}}}}else console.log("list response error",e),alert("Error: "+e.statusText)}).catch(function(t){console.log("list error",t)})}},{key:"addInputs",value:function(){var t=this;if("select"==this.type)this.inputField=document.createElement("select"),this.inputContainer.appendChild(this.inputField),this.fetchList();else if("selectivity"==this.type){if(!r)return console.error("Selectivity not found"),!1;this.inputBox=document.createElement("div"),this.inputContainer.appendChild(this.inputBox),this.selectivity=new r.Inputs.Single({element:this.inputBox,items:[],templates:{resultItem:this.renderTemplate.bind(this)},showSearchInput:!0,allowClear:!0,placeholder:this.text}),this.fetchList(),this.buttonClear=document.createElement("button"),this.buttonClear.innerHTML="🗑",this.buttonClear.type="button",this.buttonClear.className="brax-editable-button brax-editable-clear",this.buttonClear.title="Clear",this.buttonClear.addEventListener("click",function(e){return t.selectivity.setValue(null),e.preventDefault(),e.stopPropagation(),!1}),this.inputContainer.appendChild(this.buttonClear)}else if("datetime"==this.type){var e=this.value.split(" ")[0],i=this.value.split(" ")[1];this.inputDate=document.createElement("input"),this.inputDate.value=e,this.inputDate.type="date",this.inputContainer.appendChild(this.inputDate),this.inputTime=document.createElement("input"),this.inputTime.value=i,this.inputTime.type="time",this.inputContainer.appendChild(this.inputTime)}else this.inputField=document.createElement("input"),this.inputField.value=this.value,this.inputField.type=this.type,this.enterSave(this.inputField),this.inputContainer.appendChild(this.inputField);this.buttonCancel=document.createElement("button"),this.buttonCancel.innerHTML="❌",this.buttonCancel.type="button",this.buttonCancel.className="brax-editable-button brax-editable-cancel",this.buttonCancel.title="Cancel",this.buttonCancel.addEventListener("click",function(e){return t.cancel(),e.preventDefault(),e.stopPropagation(),!1}),this.inputContainer.appendChild(this.buttonCancel),this.buttonSave=document.createElement("button"),this.buttonSave.innerHTML="💾",this.buttonSave.type="button",this.buttonSave.className="brax-editable-button brax-editable-save",this.buttonSave.title="Save",this.buttonSave.addEventListener("click",function(e){return t.save(),e.preventDefault(),e.stopPropagation(),!1}),this.inputContainer.appendChild(this.buttonSave),this.hasInputs=!0}},{key:"enterSave",value:function(t){var e=this;t.addEventListener("keydown",function(t){if(13==t.keyCode)return e.save(),t.preventDefault(),t.stopPropagation(),!1})}},{key:"focus",value:function(){this.inputField&&this.inputField.focus(),this.selectivity&&this.selectivity.focus()}},{key:"cancel",value:function(){this.isEditing=!1}},{key:"save",value:function(){var t=this;this.inputsEnabled=!1,console.log("save",this.url,this.key);var e=new FormData;e.append("key",this.key),e.append("value",this.currentValue);var i={method:this.method,body:e};fetch(this.url,i).then(function(t){return 200===t.status?t.json():(console.error("response error",t),t)}).then(function(e){console.log("response",e),t.inputsEnabled=!0,"ok"==e.status?(e.newValue&&(t.value=e.newValue),e.newText&&(t.text=e.newText),e.message&&alert(e.message),(e.reload||e.refresh)&&location.reload(),e.redirect&&(location.href=e.redirect),t.isEditing=!1):(console.log("response error",e),alert("Error: "+e.statusText))}).catch(function(e){console.log("error",e),t.inputsEnabled=!0})}},{key:"renderTemplate",value:function(t){return"test"==this.template?'<div class="selectivity-result-item" data-item-id="'+t.id+'">\n\t\t\t\t<em>'+escape(t.text)+"</em>\n\t\t\t\t("+t.extra+")\n\t\t\t</div>":'<div class="selectivity-result-item" data-item-id="'+t.id+'">\n\t\t\t'+escape(t.text)+"\n\t\t</div>"}},{key:"isEditing",get:function(){return this._isEditing},set:function(t){this._isEditing||0==t?(this.textContainer.style.display="inline",this.inputContainer.style.display="none"):(this.hasInputs||this.addInputs(),this.textContainer.style.display="none",this.inputContainer.style.display="flex",this.focus()),this._isEditing=t,this.element.setAttribute("data-editing",this._isEditing?1:0)}},{key:"inputsEnabled",get:function(){return this._inputsEnabled},set:function(t){this.inputField&&(this.inputField.disabled=!t),this.inputDate&&(this.inputDate.disabled=!t),this.inputTime&&(this.inputTime.disabled=!t),this.selectivity&&(this.selectivity.enabled=t),this.buttonCancel.disabled=!t,this.buttonSave.disabled=!t,this._inputsEnabled=t}},{key:"currentValue",get:function(){return this.inputDate&&this.inputTime?this.inputDate.value+" "+this.inputTime.value:this.selectivity?this.selectivity.getValue():this.inputField.value}},{key:"text",get:function(){return this._text},set:function(t){this._text=t,this.textContainer.innerHTML=t}},{key:"value",get:function(){return this._value},set:function(t){this._value=t,this.element.setAttribute("data-value",this._value),this.inputField&&(this.inputField.value=this._value)}}]),t}();e.BraxEditable=o},function(t,e,i){function n(t,e){var i=r(t,e);return s(i)?i:void 0}var s=i(28),r=i(35);t.exports=n},function(t,e,i){function n(t){return!(!o(t)||r(t))&&(s(t)?f:a).test(l(t))}var s=i(12),r=i(32),o=i(6),l=i(34),u=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,c=Function.prototype,h=Object.prototype,d=c.toString,p=h.hasOwnProperty,f=RegExp("^"+d.call(p).replace(u,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=n},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){function n(t){var e=o.call(t,u),i=t[u];try{t[u]=void 0;var n=!0}catch(t){}var s=l.call(t);return n&&(e?t[u]=i:delete t[u]),s}var s=i(4),r=Object.prototype,o=r.hasOwnProperty,l=r.toString,u=s?s.toStringTag:void 0;t.exports=n},function(t,e){function i(t){return s.call(t)}var n=Object.prototype,s=n.toString;t.exports=i},function(t,e,i){function n(t){return!!r&&r in t}var s=i(33),r=function(){var t=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();t.exports=n},function(t,e,i){var n=i(5),s=n["__core-js_shared__"];t.exports=s},function(t,e){function i(t){if(null!=t){try{return s.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var n=Function.prototype,s=n.toString;t.exports=i},function(t,e){function i(t,e){return null==t?void 0:t[e]}t.exports=i},function(t,e,i){function n(t,e,i,n){var o=!i;i||(i={});for(var l=-1,u=e.length;++l<u;){var a=e[l],c=n?n(i[a],t[a],a,i,t):void 0;void 0===c&&(c=t[a]),o?r(i,a,c):s(i,a,c)}return i}var s=i(9),r=i(10);t.exports=n},function(t,e,i){function n(t){return s(function(e,i){var n=-1,s=i.length,o=s>1?i[s-1]:void 0,l=s>2?i[2]:void 0;for(o=t.length>3&&"function"==typeof o?(s--,o):void 0,l&&r(i[0],i[1],l)&&(o=s<3?void 0:o,s=1),e=Object(e);++n<s;){var u=i[n];u&&t(e,u,n,o)}return e})}var s=i(38),r=i(45);t.exports=n},function(t,e,i){function n(t,e){return o(r(t,e,s),t+"")}var s=i(15),r=i(39),o=i(41);t.exports=n},function(t,e,i){function n(t,e,i){return e=r(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,l=r(n.length-e,0),u=Array(l);++o<l;)u[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=i(u),s(t,this,a)}}var s=i(40),r=Math.max;t.exports=n},function(t,e){function i(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}t.exports=i},function(t,e,i){var n=i(42),s=i(44),r=s(n);t.exports=r},function(t,e,i){var n=i(43),s=i(11),r=i(15),o=s?function(t,e){return s(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:r;t.exports=o},function(t,e){function i(t){return function(){return t}}t.exports=i},function(t,e){function i(t){var e=0,i=0;return function(){var o=r(),l=s-(o-i);if(i=o,l>0){if(++e>=n)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var n=800,s=16,r=Date.now;t.exports=i},function(t,e,i){function n(t,e,i){if(!l(i))return!1;var n=typeof e;return!!("number"==n?r(i)&&o(e,i.length):"string"==n&&e in i)&&s(i[e],t)}var s=i(14),r=i(7),o=i(17),l=i(6);t.exports=n},function(t,e,i){function n(t){return o(t)?s(t):r(t)}var s=i(47),r=i(57),o=i(7);t.exports=n},function(t,e,i){function n(t,e){var i=o(t),n=!i&&r(t),c=!i&&!n&&l(t),d=!i&&!n&&!c&&a(t),p=i||n||c||d,f=p?s(t.length,String):[],v=f.length;for(var m in t)!e&&!h.call(t,m)||p&&("length"==m||c&&("offset"==m||"parent"==m)||d&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||u(m,v))||f.push(m);return f}var s=i(48),r=i(49),o=i(8),l=i(51),u=i(17),a=i(53),c=Object.prototype,h=c.hasOwnProperty;t.exports=n},function(t,e){function i(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}t.exports=i},function(t,e,i){var n=i(50),s=i(2),r=Object.prototype,o=r.hasOwnProperty,l=r.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(t){return s(t)&&o.call(t,"callee")&&!l.call(t,"callee")};t.exports=u},function(t,e,i){function n(t){return r(t)&&s(t)==o}var s=i(1),r=i(2),o="[object Arguments]";t.exports=n},function(t,e,i){(function(t){var n=i(5),s=i(52),r="object"==typeof e&&e&&!e.nodeType&&e,o=r&&"object"==typeof t&&t&&!t.nodeType&&t,l=o&&o.exports===r,u=l?n.Buffer:void 0,a=u?u.isBuffer:void 0,c=a||s;t.exports=c}).call(e,i(19)(t))},function(t,e){function i(){return!1}t.exports=i},function(t,e,i){var n=i(54),s=i(55),r=i(56),o=r&&r.isTypedArray,l=o?s(o):n;t.exports=l},function(t,e,i){function n(t){return o(t)&&r(t.length)&&!!l[s(t)]}var s=i(1),r=i(16),o=i(2),l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l["[object Arguments]"]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l["[object Function]"]=l["[object Map]"]=l["[object Number]"]=l["[object Object]"]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1,t.exports=n},function(t,e){function i(t){return function(e){return t(e)}}t.exports=i},function(t,e,i){(function(t){var n=i(13),s="object"==typeof e&&e&&!e.nodeType&&e,r=s&&"object"==typeof t&&t&&!t.nodeType&&t,o=r&&r.exports===s,l=o&&n.process,u=function(){try{return l&&l.binding&&l.binding("util")}catch(t){}}();t.exports=u}).call(e,i(19)(t))},function(t,e,i){function n(t){if(!s(t))return r(t);var e=[];for(var i in Object(t))l.call(t,i)&&"constructor"!=i&&e.push(i);return e}var s=i(18),r=i(58),o=Object.prototype,l=o.hasOwnProperty;t.exports=n},function(t,e,i){var n=i(59),s=n(Object.keys,Object);t.exports=s},function(t,e){function i(t,e){return function(i){return t(e(i))}}t.exports=i},function(t,e,i){"use strict";function n(t,e){for(;t&&!u(t,e);)t=t.parentElement;return t||null}function s(t,e){this.el=a(t.template("dropdown",{dropdownCssClass:t.options.dropdownCssClass,searchInputPlaceholder:t.options.searchInputPlaceholder,showSearchInput:e.showSearchInput})),this.resultsContainer=this.$(".selectivity-results-container"),this.hasMore=!1,this.highlightedResult=null,this.loadMoreHighlighted=!1,this.options=e,this.results=[],this.selectivity=t,this._closed=!1,this._lastMousePosition={},this.close=this.close.bind(this),this.position=this.position.bind(this),!1!==t.options.closeOnSelect&&t.events.on("selectivity-selecting",this.close),this.addToDom(),this.showLoading(),e.showSearchInput&&(t.initInput(this.$(".selectivity-search-input")),t.focus());var i={};i["click "+f]=this._loadMoreClicked,i["click "+v]=this._resultClicked,i["mouseenter "+f]=this._loadMoreHovered,i["mouseenter "+v]=this._resultHovered,this.events=new o(this.el,this),this.events.on(i),this._attachScrollListeners(),this._suppressWheel(),setTimeout(this.triggerOpen.bind(this),1)}var r=i(3),o=i(21),l=i(61),u=i(22),a=i(62),c=i(63),h=i(24),d=i(23),p=i(0),f=".selectivity-load-more",v=".selectivity-result-item",m=["scroll","touchend","touchmove"];r(s.prototype,{$:function(t){return this.el.querySelector(t)},addToDom:function(){this.selectivity.el.appendChild(this.el)},close:function(){this._closed||(this._closed=!0,c(this.el),this.selectivity.events.off("selectivity-selecting",this.close),this.triggerClose(),this._removeScrollListeners())},highlight:function(t,e){d(this.$(".highlight"),"highlight",!1),d(this.$(l(v,t.id)),"highlight",!0),this.highlightedResult=t,this.loadMoreHighlighted=!1,this.selectivity.triggerEvent("selectivity-highlight",{item:t,id:t.id,reason:e&&e.reason||"unspecified"})},highlightLoadMore:function(){d(this.$(".highlight"),"highlight",!1),d(this.$(f),"highlight",!0),this.highlightedResult=null,this.loadMoreHighlighted=!0},loadMore:function(){c(this.$(f)),this.resultsContainer.innerHTML+=this.selectivity.template("loading"),this.options.query({callback:function(t){if(!t||!t.results)throw new Error("callback must be passed a response object");this._showResults(p.processItems(t.results),{add:!0,hasMore:!!t.more})}.bind(this),error:this._showResults.bind(this,[],{add:!0}),offset:this.results.length,selectivity:this.selectivity,term:this.term})},position:function(){var t=this.options.position;t&&t(this.el,this.selectivity.el),this._scrolled()},renderItems:function(t){var e=this.selectivity;return t.map(function(t){var i=e.template(t.id?"resultItem":"resultLabel",t);return t.children&&(i+=e.template("resultChildren",{childrenHtml:this.renderItems(t.children)})),i},this).join("")},search:function(t){if(this.term=t,this.options.items){t=p.transformText(t);var e=this.selectivity.options.matcher||p.matcher;this._showResults(this.options.items.map(function(i){return e(i,t)}).filter(function(t){return!!t}),{term:t})}else this.options.query&&this.options.query({callback:function(e){if(!e||!e.results)throw new Error("callback must be passed a response object");this._showResults(p.processItems(e.results),{hasMore:!!e.more,term:t})}.bind(this),error:this.showError.bind(this),offset:0,selectivity:this.selectivity,term:t})},selectHighlight:function(){this.highlightedResult?this.selectItem(this.highlightedResult.id):this.loadMoreHighlighted&&this.loadMore()},selectItem:function(t){var e=p.findNestedById(this.results,t);if(e&&!e.disabled&&!1!==e.selectable){var i={id:t,item:e};this.selectivity.triggerEvent("selectivity-selecting",i)&&this.selectivity.triggerEvent("selectivity-selected",i)}},showError:function(t,e){this.resultsContainer.innerHTML=this.selectivity.template("error",{escape:!e||!1!==e.escape,message:t}),this.hasMore=!1,this.results=[],this.highlightedResult=null,this.loadMoreHighlighted=!1,this.position()},showLoading:function(){this.resultsContainer.innerHTML=this.selectivity.template("loading"),this.hasMore=!1,this.results=[],this.highlightedResult=null,this.loadMoreHighlighted=!1,this.position()},showResults:function(t,e){e.add?c(this.$(".selectivity-loading")):this.resultsContainer.innerHTML="";var i=this.selectivity.filterResults(t),n=this.renderItems(i);e.hasMore?n+=this.selectivity.template("loadMore"):n||e.add||(n=this.selectivity.template("noResults",{term:e.term})),this.resultsContainer.innerHTML+=n,this.results=e.add?this.results.concat(t):t,this.hasMore=e.hasMore;var s=this.selectivity.getValue();if(s&&!Array.isArray(s)){var r=p.findNestedById(t,s);r&&this.highlight(r,{reason:"current_value"})}else!1===this.options.highlightFirstItem||e.add&&!this.loadMoreHighlighted||this._highlightFirstItem(i);this.position()},triggerClose:function(){this.selectivity.triggerEvent("selectivity-close")},triggerOpen:function(){this.selectivity.triggerEvent("selectivity-open")},_attachScrollListeners:function(){for(var t=0;t<m.length;t++)window.addEventListener(m[t],this.position,!0);window.addEventListener("resize",this.position)},_highlightFirstItem:function(t){function e(t){for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s.id)return s;if(s.children){var r=e(s.children);if(r)return r}}}var i=e(t);i?this.highlight(i,{reason:"first_result"}):(this.highlightedResult=null,this.loadMoreHighlighted=!1)},_loadMoreClicked:function(t){this.loadMore(),h(t)},_loadMoreHovered:function(t){void 0!==t.screenX&&t.screenX===this._lastMousePosition.x&&void 0!==t.screenY&&t.screenY===this._lastMousePosition.y||(this.highlightLoadMore(),this._recordMousePosition(t))},_recordMousePosition:function(t){this._lastMousePosition={x:t.screenX,y:t.screenY}},_removeScrollListeners:function(){for(var t=0;t<m.length;t++)window.removeEventListener(m[t],this.position,!0);window.removeEventListener("resize",this.position)},_resultClicked:function(t){this.selectItem(this.selectivity.getRelatedItemId(t)),h(t)},_resultHovered:function(t){if(!t.screenX||t.screenX!==this._lastMousePosition.x||!t.screenY||t.screenY!==this._lastMousePosition.y){var e=this.selectivity.getRelatedItemId(t),i=p.findNestedById(this.results,e);i&&!i.disabled&&this.highlight(i,{reason:"hovered"}),this._recordMousePosition(t)}},_scrolled:function(){var t=this.$(f);t&&t.offsetTop-this.resultsContainer.scrollTop<this.el.clientHeight&&this.loadMore()},_showResults:function(t,e){this.showResults(t,r({dropdown:this},e))},_suppressWheel:function(){var t=this.selectivity.options.suppressWheelSelector;if(null!==t){var e=t||".selectivity-results-container";this.events.on("wheel",e,function(t){function i(){h(t),t.preventDefault()}var s=0===t.deltaMode?t.deltaY:40*t.deltaY,r=n(t.target,e),o=r.clientHeight,l=r.scrollHeight,u=r.scrollTop;l>o&&(s<-u?(r.scrollTop=0,i()):s>l-o-u&&(r.scrollTop=l,i()))})}}}),t.exports=p.Dropdown=s},function(t,e,i){"use strict";t.exports=function(t,e){return t+'[data-item-id="'+(""+e).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"]'}},function(t,e,i){"use strict";t.exports=function(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild}},function(t,e,i){"use strict";t.exports=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}},function(t,e,i){"use strict";function n(t){r.call(this,s({positionDropdown:function(t,e){var i=e.getBoundingClientRect(),n=i.bottom,r=Math.min(Math.max(n+t.clientHeight-window.innerHeight,0),i.top+i.height);s(t.style,{left:i.left+"px",top:n-r+"px",width:i.width+"px"})}},t)),this.el.innerHTML=this.template("singleSelectInput",this.options),this.rerenderSelection(),!1===t.showSearchInputInDropdown&&this.initInput(this.$(".selectivity-single-select-input"),{search:!1}),this.events.on({change:this.rerenderSelection,click:this._clicked,"click .selectivity-search-input":o,"click .selectivity-single-selected-item-remove":this._itemRemoveClicked,"focus .selectivity-single-select-input":this._focused,"selectivity-selected":this._resultSelected})}var s=i(3),r=i(0),o=i(24),l=r.inherits(n,r,{clear:function(){this.setData(null)},close:function(t){this._closing=!0,l(this,"close"),t&&t.keepFocus&&this.input&&this.input.focus(),this._closing=!1},getDataForValue:function(t){return this.getItemForId(t)},getValueForData:function(t){return t?t.id:null},rerenderSelection:function(){var t=this._data?"singleSelectedItem":"singleSelectPlaceholder",e=this._data?s({removable:this.options.allowClear&&!this.options.readOnly},this._data):{placeholder:this.options.placeholder};this.el.querySelector("input").value=this._value,this.$(".selectivity-single-result-container").innerHTML=this.template(t,e)},validateData:function(t){return null===t?t:this.validateItem(t)},validateValue:function(t){if(null===t||r.isValidId(t))return t;throw new Error("Value for SingleSelectivity instance should be a valid ID or null")},_clicked:function(){this.enabled&&(this.dropdown?this.close({keepFocus:!0}):!1!==this.options.showDropdown&&this.open())},_focused:function(){!this.enabled||this._closing||this._opening||!1===this.options.showDropdown||this.open()},_itemRemoveClicked:function(t){this.setData(null),o(t)},_resultSelected:function(t){this.setData(t.item),this.close({keepFocus:!0})}});t.exports=r.Inputs.Single=n},function(t,e,i){"use strict";var n=i(25),s=i(0),r=i(72);s.Templates={dropdown:function(t){var e=t.dropdownCssClass?" "+t.dropdownCssClass:"",i="";if(t.showSearchInput){e+=" has-search-input";var s=t.searchInputPlaceholder;i='<div class="selectivity-search-input-container"><input type="text" class="selectivity-search-input"'+(s?' placeholder="'+n(s)+'"':"")+"></div>"}return'<div class="selectivity-dropdown'+e+'">'+i+'<div class="selectivity-results-container"></div></div>'},error:function(t){return'<div class="selectivity-error">'+(t.escape?n(t.message):t.message)+"</div>"},loading:function(){return'<div class="selectivity-loading">'+r.loading+"</div>"},loadMore:function(){return'<div class="selectivity-load-more">'+r.loadMore+"</div>"},multipleSelectInput:function(t){return'<div class="selectivity-multiple-input-container">'+(t.enabled?'<input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" class="selectivity-multiple-input">':'<div class="selectivity-multiple-input selectivity-placeholder"></div>')+'<div class="selectivity-clearfix"></div></div>'},multipleSelectedItem:function(t){return'<span class="selectivity-multiple-selected-item'+(t.highlighted?" highlighted":"")+'" data-item-id="'+n(t.id)+'">'+(t.removable?'<a class="selectivity-multiple-selected-item-remove"><i class="fa fa-remove"></i></a>':"")+n(t.text)+"</span>"},noResults:function(t){return'<div class="selectivity-error">'+(t.term?r.noResultsForTerm(t.term):r.noResults)+"</div>"},resultChildren:function(t){return'<div class="selectivity-result-children">'+t.childrenHtml+"</div>"},resultItem:function(t){return'<div class="selectivity-result-item'+(t.disabled?" disabled":"")+'" data-item-id="'+n(t.id)+'">'+n(t.text)+(t.submenu?'<i class="selectivity-submenu-icon fa fa-chevron-right"></i>':"")+"</div>"},resultLabel:function(t){return'<div class="selectivity-result-label">'+n(t.text)+"</div>"},singleSelectInput:function(t){return'<div class="selectivity-single-select"><input type="text" class="selectivity-single-select-input"'+(t.required?" required":"")+'><div class="selectivity-single-result-container"></div><i class="fa fa-sort-desc selectivity-caret"></i></div>'},singleSelectPlaceholder:function(t){return'<div class="selectivity-placeholder">'+n(t.placeholder)+"</div>"},singleSelectedItem:function(t){return'<span class="selectivity-single-selected-item" data-item-id="'+n(t.id)+'">'+(t.removable?'<a class="selectivity-single-selected-item-remove"><i class="fa fa-remove"></i></a>':"")+n(t.text)+"</span>"},selectCompliance:function(t){var e=t.mode,i=t.name;return"multiple"===e&&"[]"!==i.slice(-2)&&(i+="[]"),'<select name="'+i+'"'+("multiple"===e?" multiple":"")+"></select>"},selectOptionCompliance:function(t){return'<option value="'+n(t.id)+'" selected>'+n(t.text)+"</option>"}}},function(t,e,i){var n=i(67),s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},r=n(s);t.exports=r},function(t,e){function i(t){return function(e){return null==t?void 0:t[e]}}t.exports=i},function(t,e,i){function n(t){return null==t?"":s(t)}var s=i(69);t.exports=n},function(t,e,i){function n(t){if("string"==typeof t)return t;if(o(t))return r(t,n)+"";if(l(t))return c?c.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}var s=i(4),r=i(70),o=i(8),l=i(71),u=1/0,a=s?s.prototype:void 0,c=a?a.toString:void 0;t.exports=n},function(t,e){function i(t,e){for(var i=-1,n=null==t?0:t.length,s=Array(n);++i<n;)s[i]=e(t[i],i,t);return s}t.exports=i},function(t,e,i){function n(t){return"symbol"==typeof t||r(t)&&s(t)==o}var s=i(1),r=i(2),o="[object Symbol]";t.exports=n},function(t,e,i){"use strict";var n=i(25),s=i(0);t.exports=s.Locale={loading:"Loading...",loadMore:"Load more...",noResults:"No results found",ajaxError:function(t){return t?"Failed to fetch results for <b>"+n(t)+"</b>":"Failed to fetch results"},needMoreCharacters:function(t){return"Enter "+t+" more characters to search"},noResultsForTerm:function(t){return"No results for <b>"+n(t)+"</b>"}}}])});